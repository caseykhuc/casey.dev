---
title: "Client side rendering vs Pre-rendering (Server-side Rendering + Static Site Generation)"
dateString: "October 31, 2022"
mainImageUrl: "/images/blogs/000060.JPG"
tags: ["nextjs", "frontend"]
---


Client-side rendering, server-side rendering, static site generation. Cháº¯c háº³n nhá»¯ng cá»¥m tá»« nÃ y ráº¥t quen thuá»™c Ä‘á»‘i vá»›i cÃ¡c báº¡n tÃ¬m hiá»ƒu vá» Láº­p trÃ¬nh Web. BÃ i viáº¿t nÃ y sáº½ lÃ m sÃ¡ng tá» hÆ¡n 2 khÃ¡i niá»‡m nÃ y cÅ©ng nhÆ° chia sáº» kinh nghiá»‡m khi sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p rendering khÃ¡c nhau.

## First thing first, client vÃ  server lÃ  gÃ¬?
<h2>First thing first, client vÃ  server lÃ  gÃ¬?</h2>

> Client: A machine or program that make requests through the web.

Trong bÃ i viáº¿t, **_client Ä‘Æ°á»£c hiá»ƒu vá»›i nghÄ©a Ä‘Æ¡n giáº£n lÃ  web browser._** KhÃ´ng cÃ³ gÃ¬ xa láº¡, browser hay trÃ¬nh duyá»‡t web chÃ­nh lÃ  Chrome, Firefox hay Safari, cÃ´ng cá»¥ cÃ¡c báº¡n Ä‘ang sá»­ dá»¥ng Ä‘á»ƒ truy cáº­p vÃ  tÆ°Æ¡ng tÃ¡c vá»›i cÃ¡c websites.

> Server: In computing, a server is a piece of computer hardware or software (computer program) that provides functionality for other programs or devices, called "clients".

Khi Ä‘Æ°á»£c há»c trong trÆ°á»ng, hoáº·c nghe tá»›i viá»‡c server Ä‘Æ°á»£c Ä‘áº·t táº¡i Singapore, Má»¹,... thá»±c thá»ƒ Ä‘Æ°á»£c nháº¯c tá»›i á»Ÿ Ä‘Ã¢y lÃ  nhá»¯ng chiáº¿c mÃ¡y tÃ­nh, Ä‘iá»ƒn hÃ¬nh thÃ¬ cÃ³ high performance, thá»±c hiá»‡n Ä‘Æ°á»£c ráº¥t nhiá»u tÃ¡c vá»¥. Tuy nhiÃªn, server mÃ¬nh muá»‘n nháº¯c tá»›i á»Ÿ Ä‘Ã¢y lÃ  **_nhá»¯ng program Ä‘Æ°á»£c cháº¡y trÃªn nhá»¯ng chiáº¿c mÃ¡y Ä‘Ã³._**

### FYI

CÃ³ ráº¥t nhiá»u thuáº­t ngá»¯ cÃ³ chá»©a chá»¯ "server" vÃ­ dá»¥ nhÆ°: Web server (NÆ¡i lÆ°u trá»¯ ná»™i dung cá»§a website), Database server, etc nhÆ°ng Ä‘Ã³ khÃ´ng pháº£i lÃ  Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c nháº¯c Ä‘áº¿n trong bÃ i viáº¿t.

TÃ³m láº¡i: servers lÃ  nhá»¯ng programs (code). ChÃºng xá»­ lÃ­, thá»±c hiá»‡n tÃ¡c vá»¥ Ä‘á»ƒ serve (phá»¥c vá»¥) cho clients programs (frontend code).

### FYI

- MÃ´ hÃ¬nh client-server ráº¥t phá»• biáº¿n, nhÆ°ng khÃ´ng pháº£i lÃ  mÃ´ hÃ¬nh website duy nháº¥t.
- There's alternative: decentrialzed structure (The Peer-to-Peer model - BitTorrent - Video chat protocols)

## CÃ¢u chuyá»‡n lá»‹ch sá»­

### Once upon a time
[!alt text](https:///)

Trong nhiá»u nÄƒm trÆ°á»›c, háº§u háº¿t cÃ¡c websites chá»‰ sá»­ dá»¥ng server side rendering. Má»™t website Ä‘iá»ƒn hÃ¬nh thá»i báº¥y giá» lÃ  Multiple Page Application (MPA). VÃ­ dá»¥ má»™t trang web giá»›i thiá»‡u nhÃ  hÃ ng cÃ³ 4 trang: _Home_, _About_, _Menu_, _Review_. Má»—i trang nÃ y sáº½ tÆ°Æ¡ng á»©ng vá»›i 1 file html. NgÆ°á»i dÃ¹ng khi Ä‘ang á»Ÿ trang Menu, báº¥m chuyá»ƒn sang trang About, browser sáº½ gá»i 1 request má»›i Ä‘á»ƒ láº¥y vá» file html cá»§a trang About nÃ y. NÃ´m na nhÆ° sau:

- User vÃ o `/menu` => client gá»­i 1 request Ä‘áº¿n server
- Server láº¥y thÃ´ng tin tá»« database, render ra HTML
- **_Server tráº£ vá» menu.html cho client_**
- Client dÃ¹ng response trÃªn Ä‘á»ƒ hiá»ƒn thá»‹ ra trang web
- User click sang trang `/about` => client gá»­i 1 request khÃ¡c
- **_Server tÃ­nh toÃ¡n, sau Ä‘Ã³ tráº£ láº¡i about.html cho client_**

Code thá»i Ä‘Ã³ trÃ´ng sáº½ Ä‘áº¡i loáº¡i nhÆ° tháº¿ nÃ y:

```php
// Establishing Connection with Server
$connection = mysql_connect("localhost", "root", "");
$db = mysql_select_db("company", $connection);

// MySQL Query to read data
$menu_query = mysql_query("select * from dishes", $connection);

// Construct HTML
while ($row = mysql_fetch_array($query)) {
	echo "<b><a href="readphp.php?id={$row['dish_id']}">{$row['dish_name']}</a></b>";
	echo "<br />";
}
// -- other steps to complete HTML file
```

### The Javascript Revolution

Rá»“i má»™t ngÃ y, tháº¿ giá»›i láº­p trÃ¬nh web bÆ°á»›c sang trang má»›i, nhá» vÃ o `The JavaScript revolution`

- Javascript sinh ra vÃ o nÄƒm 1995 nhÆ° má»™t ngÃ´n ngá»¯ dÃ¹ng Ä‘á»ƒ táº¡o thÃªm hiá»‡u á»©ng UI (UI-enhancing) hoáº·c xá»­ lÃ­ validation cho cÃ¡c trang web. CÃ ng ngÃ y, cÃ¡c trÃ¬nh duyá»‡t web (browsers) cÃ ng trá»Ÿ nÃªn máº¡nh máº½ hÆ¡n, vá»›i Ajax trong IE vÃ  XMLHttpRequest khoáº£ng nhá»¯ng nÄƒm 2000.
- ChÃ­nh nhá» nhá»¯ng tÃ­nh nÄƒng má»›i nÃ y cá»§a browser, trong khoáº£ng 2005-2010 Javascript Ä‘Ã£ cÃ³ thá»ƒ lÃ m nhÆ°ng Ä‘iá»u máº¡nh máº½ hÆ¡n nhiá»u so vá»›i thá»i Ä‘iá»ƒm khai sinh. TrÃªn tháº¿ giá»›i báº¯t Ä‘áº§u xuáº¥t hiá»‡n nhá»¯ng websites / web apps cháº¡y ráº¥t nhanh, khÃ´ng refresh khi chuyá»ƒn Ä‘á»•i tab, Ä‘Æ°á»£c viáº¿t hoÃ n toÃ n báº±ng Javascript cháº¡y á»Ÿ client-side. ÄÃ³ chÃ­nh lÃ  nhá»¯ng Single Page Application Ä‘áº§u tiÃªn, sá»­ dá»¥ng **_client-side rendering._**

## Äá»‹nh nghÄ©a

TÃºm vÃ¡y láº¡i, rá»‘t cuá»™c 3 phÆ°Æ¡ng phÃ¡p render nÃ y nghÄ©a lÃ  gÃ¬?

Client-side rendering:

- **HTML Ä‘Æ°á»£c render trá»±c tiáº¿p á»Ÿ browser** khi ngÆ°á»i dÃ¹ng truy cáº­p.
- CÃ¡c tÃ­nh nÄƒng routing, data fetching, nhiá»u logic Ä‘á»ƒ dá»±ng lÃªn ná»™i dung website cÅ©ng Ä‘Æ°á»£c xá»­ lÃ­ á»Ÿ phÃ­a client.

Pre-rendering gá»“m 2 hÃ¬nh thá»©c:
Server-side rendering:

- HTML Ä‘Æ°á»£c generate tá»« server. Ná»™i dung nÃ y Ä‘Æ°á»£c generate **_má»—i khi nháº­n Ä‘Æ°á»£c request tá»« client_** (má»—i khi ngÆ°á»i dÃ¹ng truy cáº­p).

Static Site Generation:

- HTML Ä‘Æ°á»£c **generate 1 láº§n á»Ÿ build time**. HTML pre-built nÃ y Ä‘Æ°á»£c tÃ¡i sá»­ dá»¥ng trong táº¥t cáº£ cÃ¡c request vÃ o trang web.

## So sÃ¡nh giá»¯a client-side vÃ  pre-rendering

### Vá» SEO

Pre-rendering luÃ´n mang láº¡i hiá»‡u quáº£ SEO cao hÆ¡n. Váº¥n Ä‘á» cá»§a client-side rendering lÃ  gÃ¬?

- Vá»›i CSR, cÃ¡c thÃ nh pháº§n cá»§a trang web nhÆ° Header, Footer, Sidebar, Content Ä‘á»u Ä‘Æ°á»£c Javascript sinh ra vÃ  gáº¯n vÃ o DOM dáº§n dáº§n. Do váº­y, ngay khi truy cáº­p 1 trang web, HTML Ä‘Æ°á»£c server gá»­i vá» sáº½ háº§u nhÆ° khÃ´ng cÃ³ ná»™i dung:

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#1a1a1a" />
    <meta name="description" content="GiÃºp TÃ´i! - Operations Portal" />
    <link rel="apple-touch-icon" href="/logo192.png" />
    <link rel="manifest" href="/manifest.json" />
    <title>A web application</title>
    <script type="module" crossorigin src="/assets/index.9aa86fe2.js"></script>
    <link rel="modulepreload" href="/assets/vendor.2b4b6168.js" />
    <link rel="stylesheet" href="/assets/index.23cbeab2.css" />
  </head>
  <body id="body">
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
</html>
```

TÃ³m láº¡i, lÃ  cháº£ cÃ³ ná»™i dung gÃ¬ cÃ³ Ã½ nghÄ©a cáº£ ğŸ˜…ğŸ˜… Äiá»u nÃ y sáº½ áº£nh hÆ°á»Ÿng tá»›i Ä‘iá»ƒm SEO cá»§a trang, do web crawlers sáº½ khÃ´ng Ä‘á»c Ä‘Æ°á»£c ná»™i dung chÃ­nh cá»§a trang web, vÃ­ dá»¥ nhÆ° cÃ¡c tagline, marketing content cá»§a website cÃ´ng ty, vÃ¢n vÃ¢n.

FYI:

- Tuy crawlers cá»§a Google Ä‘Ã£ cÃ³ kháº£ nÄƒng Ä‘á»c hiá»ƒu Javascript, váº«n cÃ³ nhá»¯ng Ä‘iá»ƒm háº¡n cháº¿ liÃªn quan tá»›i SEO cá»§a client-side rendering. [Äá»c thÃªm](https://developers.google.com/search/docs/advanced/javascript/fix-search-javascript)

### Vá» Social Sharing

Khi ta share 1 website lÃªn facebook, trong háº§u háº¿t trÆ°á»ng há»£p, thumbnail, title vÃ  1 dÃ²ng giá»›i thiá»‡u sáº½ hiá»‡n ra sau 1-2 giÃ¢y. Äiá»u nÃ y khÃ´ng tá»± nhiÃªn mÃ  cÃ³, mÃ  Ä‘á»u lÃ  do Developer viáº¿t code mÃ  ra :D

Äá»c thÃªm vá» Social Meta Tags á»Ÿ [Ä‘Ã¢y](https://css-tricks.com/essential-meta-tags-social-media/). TÃ³m láº¡i, Ä‘á»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u nÃ y, ta pháº£i gáº¯n thÃªm 1 sá»‘ tháº» `<meta>` vÃ o pháº§n `head` cá»§a file HTML - chÃ­nh lÃ  **_response cá»§a request Ä‘áº§u tiÃªn client gá»i lÃªn server khi ngÆ°á»i dÃ¹ng truy cáº­p trang web_** (\*).

Láº¥y vÃ­ dá»¥ vá»›i yÃªu cáº§u thumbnail pháº£i lÃ  áº£nh Ä‘áº§u tiÃªn xuáº¥t hiá»‡n trong trang web. Vá»›i CRS, ráº¥t khÃ³ Ä‘á»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u nÃ y. VÃ¬ trong request Ä‘áº§u tiÃªn, server Ä‘Æ¡n thuáº§n tráº£ vá» file HTML rá»—ng (xem pháº§n SEO) vÃ  sau Ä‘Ã³ lÃ  file Javascript chá»©a cÃ¡c logic rendering. Ta Ä‘Ã¢u biáº¿t hÃ¬nh áº£nh Ä‘áº§u tiÃªn trong trang web lÃ  gÃ¬ cho Ä‘áº¿n sau khi Javascript cháº¡y!

Vá»›i SSR, Ä‘iá»u nÃ y láº¡i ráº¥t Ä‘Æ¡n giáº£n. VÃ¬ logic rendering náº±m á»Ÿ phÃ­a server. Server hoÃ n toÃ n cÃ³ thá»ƒ cháº¡y code, rendering ra HTML, tÃ­nh toÃ¡n vÃ  sá»­a pháº§n head cá»§a HTML, sau Ä‘Ã³ má»›i gá»­i file nÃ y vá» cho client. HoÃ n toÃ n thoáº£ mÃ£n Ä‘iá»u kiá»‡n (\*) á»Ÿ trÃªn

### Vá» performance

#### Client-side rendering

**_NhÆ°á»£c Ä‘iá»ƒm lá»›n nháº¥t cá»§a CSR lÃ  initial load cÃ³ thá»ƒ ráº¥t cháº­m_**, Ä‘áº·c biá»‡t vá»›i cÃ¡c web apps lá»›n. LÃ½ do lÃ  vÃ¬ file JS lá»›n chá»©a logic pháº£i Ä‘Æ°á»£c browser nháº­n tá»« server, sau Ä‘Ã³ gá»i cÃ¡c API náº¿u cáº§n, cuá»‘i cÃ¹ng má»›i Ä‘áº¿n bÆ°á»›c render.

May máº¯n lÃ  Ä‘Ã£ cÃ³ ráº¥t nhiá»u giáº£i phÃ¡p cho váº¥n Ä‘á» nÃ y. CÆ¡ báº£n nháº¥t cÃ³ thá»ƒ ká»ƒ Ä‘áº¿n [code-splitting](https://webpack.js.org/guides/code-splitting/) (Æ°u tiÃªn load Ä‘oáº¡n JS cáº§n thiáº¿t), hoáº·c nÃ¢ng cao hÆ¡n lÃ  [PRPL pattern](https://web.dev/apply-instant-loading-with-prpl/).

**_Æ¯u Ä‘iá»ƒm cá»§a CSR lÃ  web app sáº½ chá»‰ cáº§n load lÃªn 1 láº§n, chuyá»ƒn trang mÆ°á»£t mÃ  khÃ´ng cáº§n refresh._**

#### Server-side rendering

VÃ¬ server cáº§n thá»i gian tÃ­nh toÃ¡n rá»“i má»›i pháº£n há»“i Ä‘Æ°á»£c request tá»« client, nÃªn ta sáº½ máº¥t thá»i gian chá» ban Ä‘áº§u:

- Slow Time to First Byte

Tuy nhiÃªn, khi cÃ³ first byte cÅ©ng lÃ  lÃºc Ä‘Ã£ cÃ³ content cá»§a cáº£ website, nÃªn chá»‰ sá»‘ First Contentful Paint cá»§a SSR sáº½ cao. Äá»ƒ tá»•ng há»£p thÃ¬ SSR cÃ³ nhá»¯ng Æ°u Ä‘iá»ƒm sau:

- Fast First Paint
- Fast First Contentful Paint
- Fast Time to Interactive (lighter JS sent to client)

#### Static Site Generation

ÄÃ¢y cháº¯c cháº¯n lÃ  phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ website cÃ³ performance tá»‘t nháº¥t, vÃ¬ má»i files tÄ©nh Ä‘Ã£ Ä‘Æ°á»£c generated sáºµn, chá»‰ chá» request tá»›i lÃ  cÃ³ thá»ƒ serve ngay. Tuy nhiÃªn, khÃ´ng pháº£i trang web nÃ o cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng SSG. Nhá»¯ng trang cÃ³ thÃ´ng tin cáº§n Ä‘Æ°á»£c update, thÃªm xoÃ¡ liÃªn tá»¥c nhÆ° e-magazine, trang Ä‘áº¥u giÃ¡, ta khÃ´ng thá»ƒ build láº¡i cáº£ trang web tá»«ng giÃ¢y, tá»«ng phÃºt - sáº½ ráº¥t tá»‘n resource.

TÃ³m láº¡i xÃ¢y dá»±ng má»™t website, hÃ£y tá»± há»i: Page nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c generate ra trÆ°á»›c khi user truy cáº­p Ä‘Æ°á»£c khÃ´ng? Náº¿u cÃ³, cá»© SSG mÃ  xÃ i. Náº¿u khÃ´ng, hÃ£y cÃ¢n nháº¯c SSR hoáº·c CSR. (Nguá»“n: https://nextjs.org/learn/basics/data-fetching/pre-rendering)

### Others

- Development time: CRS is often prefered
